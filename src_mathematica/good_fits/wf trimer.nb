(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34414,        810]
NotebookOptionsPosition[     31628,        758]
NotebookOutlinePosition[     32072,        775]
CellTagsIndexPosition[     32029,        772]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"Off", "[", 
    RowBox[{
     StyleBox[
      RowBox[{"General", "::", "munfl"}], "MessageName"], 
     StyleBox[",", "MessageName"], 
     RowBox[{"FindFit", "::", "cvmit"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{
   StyleBox[
    RowBox[{"General", "::", "munfl"}], "MessageName"], 
   StyleBox[",", "MessageName"], 
   RowBox[{"General", "::", "stop"}], ",", 
   RowBox[{"LinearSolve", "::", "luc"}], ",", 
   RowBox[{"FindFit", "::", "cvmit"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8868099639307537`*^9, 3.886809971912171*^9}, {
  3.886810014351569*^9, 3.886810018457185*^9}, {3.8868100632171164`*^9, 
  3.8868100792173653`*^9}, {3.886810162920635*^9, 3.886810166963867*^9}, {
  3.886811555557131*^9, 3.8868115824505243`*^9}, {3.886811621708199*^9, 
  3.8868116566612797`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"cf04348f-7816-4b2f-8ae2-b22df846011d"],

Cell[BoxData["\<\"/home/johannesk/kette_repo/limit_cycles/src_mathematica/\
good_fits\"\>"], "Output",
 CellChangeTimes->{3.8872327196167917`*^9, 3.887232962139443*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"57912313-619e-41a3-8f5e-85e5da2914ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LECsNUCL", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<../LECs_nucl_Joki.dat\>\"", ",", "\"\<Table\>\""}], "]"}], 
     "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"activeLEC", "=", 
   RowBox[{"LECsNUCL", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", "=", "197.327053"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Mm", "=", "938.92"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m1", "=", 
   RowBox[{"2", " ", "Mm"}]}], ";", 
  RowBox[{"m2", "=", " ", "Mm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]", "=", 
   RowBox[{"m1", " ", 
    RowBox[{"m2", "/", 
     RowBox[{"(", 
      RowBox[{"m1", "+", "m2"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mh2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Mu]"}], ")"}], "/", 
    RowBox[{
     RowBox[{"(", "hbar", ")"}], "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"1", "/", "mh2"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.806896936913022*^9, 3.8068970008591266`*^9}, 
   3.806897170588989*^9, 3.8069185960989933`*^9, 3.828961525247902*^9, {
   3.82896195420479*^9, 3.828961958065777*^9}, 3.829047005911919*^9, 
   3.829049549313146*^9, 3.829050563497466*^9, {3.829111485536989*^9, 
   3.82911149275898*^9}, {3.829111954111908*^9, 3.8291119612539*^9}, {
   3.829112252140929*^9, 3.829112261893633*^9}, {3.829112573732985*^9, 
   3.829112651253894*^9}, {3.8291128337762623`*^9, 3.829112883724078*^9}, {
   3.829113166587775*^9, 3.8291131806499767`*^9}, {3.829113328957966*^9, 
   3.829113359441307*^9}, {3.829113389516396*^9, 3.829113421977861*^9}, 
   3.82911359058664*^9, {3.831020999626773*^9, 3.831021052854327*^9}, {
   3.831021137239236*^9, 3.831021161717834*^9}, {3.831021192429678*^9, 
   3.831021281026369*^9}, {3.831021336132536*^9, 3.831021437429002*^9}, {
   3.831032542266756*^9, 3.8310325557267437`*^9}, {3.834050512313829*^9, 
   3.834050517106021*^9}, {3.834050604750242*^9, 3.834050630559705*^9}, {
   3.834050750565744*^9, 3.83405077321001*^9}, {3.834050823224724*^9, 
   3.8340508902194643`*^9}, {3.834050957167952*^9, 3.834050973889583*^9}, {
   3.834052294530594*^9, 3.834052435905081*^9}, {3.83465332463794*^9, 
   3.8346534999392233`*^9}, {3.8357552237033463`*^9, 3.835755238065895*^9}, 
   3.835756956831279*^9, {3.835759112957494*^9, 3.8357591266674023`*^9}, {
   3.83575916390582*^9, 3.835759178021888*^9}, 3.83620997072495*^9, {
   3.83621035297618*^9, 3.836210429280836*^9}, {3.840523938427368*^9, 
   3.840524020511397*^9}, {3.840697378938952*^9, 3.840697451024289*^9}, {
   3.84137465740092*^9, 3.8413747378881598`*^9}, {3.8413747790104237`*^9, 
   3.8413747864186783`*^9}, {3.841374848538939*^9, 3.841374849132146*^9}, {
   3.841374890194478*^9, 3.841374964797176*^9}, 3.841375120156419*^9, {
   3.841375263998637*^9, 3.8413753719531593`*^9}, {3.841375402268126*^9, 
   3.841375402827441*^9}, {3.841375468144746*^9, 3.8413755600898323`*^9}, {
   3.855570823759363*^9, 3.855570831337441*^9}, 3.855571422722322*^9, {
   3.855651207266287*^9, 3.855651235174877*^9}, {3.855722420660387*^9, 
   3.855722425128508*^9}, {3.8603765100850153`*^9, 3.860376518611704*^9}, 
   3.860376579439577*^9, {3.875072442974223*^9, 3.875072573691984*^9}, {
   3.876266776807109*^9, 3.876266829985648*^9}, 3.876980116419195*^9, {
   3.876980157396861*^9, 3.876980179743556*^9}, 3.8769817535983562`*^9, {
   3.881214732169114*^9, 3.881214818255166*^9}, 3.881214867434598*^9, 
   3.881651217243663*^9, {3.881651265148467*^9, 3.881651269548263*^9}, {
   3.881730031418*^9, 3.881730078791593*^9}, 3.885429718807684*^9, {
   3.885429769971409*^9, 3.885429779421628*^9}, {3.8859733632464952`*^9, 
   3.8859733996630163`*^9}, {3.886381243492303*^9, 3.886381274477777*^9}, 
   3.887152593397892*^9, {3.887152636956827*^9, 3.887152651253252*^9}, {
   3.887232970029624*^9, 3.887232970189232*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"35efcf03-bbc1-49e6-a283-337798143983"],

Cell[BoxData["31.103261602957232`"], "Print",
 CellChangeTimes->{{3.887152805661826*^9, 3.8871528073072433`*^9}, {
   3.8871531130570593`*^9, 3.887153114695756*^9}, {3.887153194504979*^9, 
   3.8871531960699053`*^9}, 3.8871537005029793`*^9, 3.887154010149467*^9, {
   3.887154057524427*^9, 3.887154059147504*^9}, {3.887154133150298*^9, 
   3.887154134664267*^9}, 3.88715417411154*^9, {3.8871542279975357`*^9, 
   3.887154252140561*^9}, {3.8871545202186737`*^9, 3.887154521793107*^9}, {
   3.887154593483242*^9, 3.887154663498577*^9}, {3.887154738856539*^9, 
   3.887154788235956*^9}, 3.88715484020175*^9, {3.8872326439466333`*^9, 
   3.887232719696145*^9}, {3.887232959112103*^9, 3.887232970697383*^9}},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"2e00cec1-fdf5-4999-996c-304d05284fb4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"I1", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"Pi", "^", "3"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b1", "^", "2"}], "+", 
         RowBox[{"b2", "^", "2"}], "+", 
         RowBox[{"2", "b1", " ", "b2"}], "+", 
         RowBox[{"2", "b1", " ", "lam"}], "+", 
         RowBox[{"2", " ", "b2", " ", "lam"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I2", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Pi", "^", "3"}], "/", 
    RowBox[{"(", 
     RowBox[{"3", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b1", "^", "2"}], "+", 
         RowBox[{"b2", "^", "2"}], "+", 
         RowBox[{"2", "b1", " ", "b2"}], "+", 
         RowBox[{"2", "b1", " ", "lam"}], "+", 
         RowBox[{"2", " ", "b2", " ", "lam"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I3", "[", 
   RowBox[{"b1_", ",", "b2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"8", " ", 
   RowBox[{"Pi", "^", "3"}], " ", "b1", " ", 
   RowBox[{"b2", "/", 
    RowBox[{"(", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{"3", "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b1", "+", "b2"}], ")"}], "^", "4"}]}], ")"}]}]}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.886826045644166*^9, 3.886826353984159*^9}, {
   3.886826842577756*^9, 3.8868271013364153`*^9}, {3.886827139203668*^9, 
   3.886827160933782*^9}, {3.886827195769246*^9, 3.886827300449576*^9}, {
   3.886827709276452*^9, 3.886827709622191*^9}, {3.886833040491798*^9, 
   3.886833056881873*^9}, {3.886833189037633*^9, 3.886833196683869*^9}, 
   3.8868341910945473`*^9, {3.887152115289495*^9, 3.887152186706695*^9}, {
   3.8871522610148706`*^9, 3.887152371115266*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2bc62ebd-0e32-4e49-a5c6-4cabc9396e9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"locall", "=", "lam"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LECc", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"activeLEC", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "locall"}], "&"}]}],
           "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LECd", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"activeLEC", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "locall"}], "&"}]}],
           "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LECc", " ", 
        RowBox[{"I1", "[", 
         RowBox[{"lam", ",", "b1", ",", "b2"}], "]"}]}], "+", 
       RowBox[{"LECd", " ", 
        RowBox[{"I2", "[", 
         RowBox[{"lam", ",", "b1", ",", "b2"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "mh2"}], ")"}], 
        RowBox[{"I3", "[", 
         RowBox[{"b1", ",", "b2"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", 
    RowBox[{"b1_", ",", "b2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"Pi", "^", "3"}], "/", 
      RowBox[{"(", 
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{"3", "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b1", "+", "b2"}], ")"}], "^", "3"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "  ", ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852262297124173*^9, 3.852262297124173*^9}, 
   3.8522626678443975`*^9, 3.8532267951977344`*^9, 3.853227124588494*^9, {
   3.853230498909873*^9, 3.853230519102766*^9}, {3.85323056358375*^9, 
   3.853230689577078*^9}, {3.8532308705205493`*^9, 3.8532308712537766`*^9}, 
   3.853231048818413*^9, 3.853231289893648*^9, {3.853298625530425*^9, 
   3.853298637683942*^9}, {3.8533002735976334`*^9, 3.8533002887755575`*^9}, {
   3.8533014821443253`*^9, 3.8533014858587027`*^9}, {3.8535226285993876`*^9, 
   3.8535226316622157`*^9}, 3.854895908307124*^9, 3.8548960211506567`*^9, {
   3.855229248986372*^9, 3.855229290007184*^9}, {3.855309712787837*^9, 
   3.855309717662904*^9}, {3.855311481860064*^9, 3.855311483768371*^9}, {
   3.855650771146367*^9, 3.855650852916173*^9}, {3.855739954296426*^9, 
   3.855739959539967*^9}, {3.8562617195048323`*^9, 3.856261744633113*^9}, {
   3.856263303436569*^9, 3.856263310396605*^9}, {3.8564314772238827`*^9, 
   3.856431487196451*^9}, {3.856431538535982*^9, 3.85643154245259*^9}, {
   3.8564315953330593`*^9, 3.85643160274969*^9}, 3.85643165797653*^9, {
   3.856431708992791*^9, 3.856431712106429*^9}, {3.8564318010960493`*^9, 
   3.856431805782648*^9}, {3.8565159742883387`*^9, 3.85651597750677*^9}, {
   3.875072644709866*^9, 3.87507275343948*^9}, {3.875072816418131*^9, 
   3.875072904761282*^9}, {3.875073151014079*^9, 3.875073155787969*^9}, {
   3.875073358726117*^9, 3.8750733611864233`*^9}, {3.87507348671796*^9, 
   3.8750734972629223`*^9}, {3.875073643186861*^9, 3.8750736530067053`*^9}, {
   3.875073690076045*^9, 3.875073773305233*^9}, {3.87507382416695*^9, 
   3.8750739575666447`*^9}, {3.875074000848612*^9, 3.875074004687408*^9}, {
   3.8750740375920963`*^9, 3.875074039838542*^9}, {3.8750740714123383`*^9, 
   3.875074080840233*^9}, {3.875084271891074*^9, 3.875084273119851*^9}, {
   3.875685291100933*^9, 3.875685341272833*^9}, {3.875685411682775*^9, 
   3.8756854139141912`*^9}, {3.8756856451720467`*^9, 3.875685658703032*^9}, 
   3.8756858077492237`*^9, {3.8769808456831083`*^9, 3.876980874393066*^9}, {
   3.8769809069774218`*^9, 3.876981035163525*^9}, {3.876981121311613*^9, 
   3.876981139396195*^9}, {3.8769811908095713`*^9, 3.8769812420744677`*^9}, {
   3.876981345227887*^9, 3.876981364082205*^9}, {3.876981450540691*^9, 
   3.8769814588597937`*^9}, {3.8769815386121817`*^9, 
   3.8769815395085297`*^9}, {3.87698167153968*^9, 3.87698167657003*^9}, {
   3.876981802133235*^9, 3.876981862925025*^9}, {3.876982027191504*^9, 
   3.876982092725515*^9}, {3.881653235263174*^9, 3.881653236840893*^9}, {
   3.885440719685811*^9, 3.8854407289682913`*^9}, {3.88544082518581*^9, 
   3.885440827437736*^9}, {3.88544289250159*^9, 3.885442893633552*^9}, {
   3.885893396609612*^9, 3.885893397594534*^9}, {3.8868276032541437`*^9, 
   3.886827619151113*^9}, {3.886827785316635*^9, 3.8868277989585342`*^9}, 
   3.88682798956781*^9, {3.886828019890383*^9, 3.88682806893468*^9}, {
   3.8868281120814047`*^9, 3.8868281176022367`*^9}, {3.886828207283139*^9, 
   3.8868282695077257`*^9}, 3.886828731025165*^9, {3.88682881717493*^9, 
   3.886828845104453*^9}, 3.886828876929533*^9, {3.88683307544916*^9, 
   3.8868332416217833`*^9}, {3.886834259488212*^9, 3.8868343578175383`*^9}, {
   3.8868344487445183`*^9, 3.886834479317075*^9}, {3.886834687383222*^9, 
   3.8868347084492197`*^9}, {3.88715243425797*^9, 3.887152466710951*^9}, {
   3.887152502594434*^9, 3.887152547346854*^9}, {3.88715309612043*^9, 
   3.887153099736305*^9}, {3.887153145483*^9, 3.887153176631443*^9}, {
   3.8871536456548357`*^9, 3.887153654729186*^9}, {3.887232625765098*^9, 
   3.887232639974882*^9}, 3.8872344168955507`*^9, {3.887239711597486*^9, 
   3.887239717081791*^9}, 3.8872403604387913`*^9},
 CellLabel->
  "In[318]:=",ExpressionUUID->"5a238007-b3e1-452b-8b3b-7c130bd86630"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimD", "=", "24"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widths", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Subdivide", "[", 
     RowBox[{"2", ",", "1215", ",", "dimD"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lamd", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ham", "[", 
      RowBox[{"lamd", ",", 
       RowBox[{"widths", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"widths", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "dimD"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "dimD"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normm", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"norm", "[", 
       RowBox[{
        RowBox[{"widths", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"widths", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dimD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dimD"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esn", "=", 
   RowBox[{"Eigensystem", "[", "normm", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evlowthreshold", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "15"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "transf"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "esn", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", "evlowthreshold"}], "&"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trafma", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "transf", "]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       SuperscriptBox["\[Mu]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traham", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", "trafma", "]"}], ".", "hamm"}], ")"}], ".", 
     "trafma"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"evbare", "=", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Eigensystem", "[", 
       RowBox[{"{", 
        RowBox[{"hamm", ",", "normm"}], "}"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{";;", "4"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"evstable", "=", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Eigensystem", "[", "traham", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{";;", "4"}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.886833265645858*^9, 3.886833271762014*^9}, {
   3.886833339323434*^9, 3.8868333494527407`*^9}, {3.886834639486484*^9, 
   3.8868346678908863`*^9}, {3.8868358804544907`*^9, 3.886835884654442*^9}, {
   3.886836783624535*^9, 3.8868367853711576`*^9}, {3.8868369030213537`*^9, 
   3.8868369272566967`*^9}, {3.886837012469288*^9, 3.886837013099429*^9}, 
   3.887152092396377*^9, {3.88715220673015*^9, 3.887152207358666*^9}, {
   3.8871525601993837`*^9, 3.887152561513832*^9}, {3.887152786553145*^9, 
   3.887152800283319*^9}, 3.88715366167279*^9, {3.8871539699742393`*^9, 
   3.8871540050222588`*^9}, 3.8871540455695877`*^9, {3.88715410303461*^9, 
   3.887154109020401*^9}, 3.887154166460936*^9, {3.887154204294366*^9, 
   3.8871542486046124`*^9}, {3.887154293674049*^9, 3.88715432669934*^9}, {
   3.887154402744279*^9, 3.887154419000801*^9}, {3.88715447450237*^9, 
   3.887154495719109*^9}, {3.887154560879056*^9, 3.8871545878559113`*^9}, {
   3.8871546226354017`*^9, 3.887154641742457*^9}, {3.887154717615881*^9, 
   3.8871547737432957`*^9}, {3.887232677174582*^9, 3.88723270547806*^9}, {
   3.887232837887662*^9, 3.887232838210527*^9}, {3.887232981178138*^9, 
   3.887233101222*^9}, {3.887233231722543*^9, 3.887233436270741*^9}, {
   3.8872334784659567`*^9, 3.88723349763164*^9}, {3.887233650116324*^9, 
   3.8872336563913813`*^9}, {3.8872337343342447`*^9, 3.887233780266137*^9}, {
   3.887233814338901*^9, 3.887233836122044*^9}, {3.88723389877948*^9, 
   3.887233920391522*^9}, 3.887239727973456*^9, {3.887239782440754*^9, 
   3.8872399862650833`*^9}, {3.887240029214909*^9, 3.887240044889618*^9}, {
   3.887240081953562*^9, 3.887240331861792*^9}, {3.887240415968219*^9, 
   3.887240421534067*^9}},ExpressionUUID->"b4405cc3-3da0-4835-956c-\
ca9ff5f86c93"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{\\\"ComplexInfinity\\\"}]\\) \
attempted.\"", 2, 330, 12, 18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.887240366635763*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"72eb5e1f-ac13-47c6-b5ca-c74d30505530"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{\\\"ComplexInfinity\\\"}]\\) \
attempted.\"", 2, 330, 13, 18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.8872403666380444`*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"00605464-4b1d-4ee9-8876-c34c44d4e4c3"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"859.2639165406717`\\\"}], \\\"+\\\", RowBox[{\\\"3.011140816678003`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 14, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.887240366639942*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"d9e1d8ca-8d51-43c1-9610-bc861a2dd750"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"859.2639165406717`\\\"}], \\\"-\\\", RowBox[{\\\"3.011140816678003`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 15, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.887240366641733*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"9d4520a4-bcf8-49bf-8dbf-51d08fe76208"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"823.1923177153999`\\\"}], \\\"+\\\", RowBox[{\\\"26.650430162656278`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 16, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.8872403666435957`*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"72037f9e-6cc3-455a-bcfa-4dda04816b39"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"859.2639165406717`\\\"}], \\\"+\\\", RowBox[{\\\"3.011140816678003`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 17, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.887240366645357*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"821cc993-e2d0-4e72-af63-e746b63f8fc9"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"823.1923177153999`\\\"}], \\\"-\\\", RowBox[{\\\"26.65043016265628`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 18, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.8872403666470537`*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"1352a47d-be38-4208-b4d2-19d676012bdf"],

Cell[BoxData[
 TemplateBox[{
  "Less", "nord", 
   "\"Invalid comparison with \\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"823.1923177153999`\\\"}], \\\"+\\\", RowBox[{\\\"26.650430162656278`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\\) attempted.\"", 2, 330, 19, 
   18263619885251989820, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887240332653481*^9, 3.887240366648738*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"a7dfda46-c376-41c7-a46f-22fe14b7f144"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ComplexInfinity", ",", "ComplexInfinity", ",", 
   RowBox[{
    RowBox[{"-", "2680.596264916259`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "885.9953386901514`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.887239830901907*^9, 3.887239864271119*^9}, 
   3.887239905572163*^9, 3.887240049817511*^9, {3.887240105515193*^9, 
   3.8872401465546837`*^9}, {3.887240274196957*^9, 3.887240332681723*^9}, 
   3.887240366650496*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"13cdea2f-e73b-415b-bab2-6f9e9e0f89e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "886.1265711541283`"}], ",", 
   RowBox[{"-", "883.2041325626317`"}], ",", 
   RowBox[{"-", "878.703149231578`"}], ",", 
   RowBox[{"-", "872.2460059158769`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.887239830901907*^9, 3.887239864271119*^9}, 
   3.887239905572163*^9, 3.887240049817511*^9, {3.887240105515193*^9, 
   3.8872401465546837`*^9}, {3.887240274196957*^9, 3.887240332681723*^9}, 
   3.887240366650887*^9},
 CellLabel->
  "Out[331]=",ExpressionUUID->"cd381f81-e5c5-45f2-9bf7-7e2fddd6c8e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"HamMat", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NorMat", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsReal", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Element]", "Reals"}], ")"}], "&"}], "/@", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"Eigensystem", "[", 
          RowBox[{"{", 
           RowBox[{"HamMat", ",", "NorMat"}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "False"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Norm matrix is positive definite?  \>\"", ",", 
   RowBox[{"PositiveDefiniteMatrixQ", "[", "NorMat", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Hamiltonian is hermitian?  \>\"", ",", 
    RowBox[{"HermitianMatrixQ", "[", "HamMat", "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<There are complex eigenvalues?  \>\"", ",", 
   RowBox[{"IsReal", "!=", 
    RowBox[{"{", "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886833265645858*^9, 3.886833271762014*^9}, {
   3.886833339323434*^9, 3.8868333494527407`*^9}, {3.886834639486484*^9, 
   3.8868346678908863`*^9}, {3.8868358804544907`*^9, 3.886835884654442*^9}, {
   3.886836783624535*^9, 3.8868367853711576`*^9}, {3.8868369030213537`*^9, 
   3.8868369272566967`*^9}, {3.886837012469288*^9, 3.886837013099429*^9}, 
   3.887152092396377*^9, {3.88715220673015*^9, 3.887152207358666*^9}, {
   3.8871525601993837`*^9, 3.887152561513832*^9}, {3.887152786553145*^9, 
   3.887152800283319*^9}, 3.88715366167279*^9, {3.8871539699742393`*^9, 
   3.8871540050222588`*^9}, 3.8871540455695877`*^9, {3.88715410303461*^9, 
   3.887154109020401*^9}, 3.887154166460936*^9, {3.887154204294366*^9, 
   3.8871542486046124`*^9}, {3.887154293674049*^9, 3.88715432669934*^9}, {
   3.887154402744279*^9, 3.887154419000801*^9}, {3.88715447450237*^9, 
   3.887154495719109*^9}, {3.887154560879056*^9, 3.8871545878559113`*^9}, {
   3.8871546226354017`*^9, 3.887154641742457*^9}, {3.887154717615881*^9, 
   3.8871547737432957`*^9}, {3.887232677174582*^9, 3.88723270547806*^9}, {
   3.887232837887662*^9, 3.887232838210527*^9}, {3.887232981178138*^9, 
   3.887233101222*^9}, {3.887233231722543*^9, 3.887233436270741*^9}, {
   3.8872334784659567`*^9, 3.88723349763164*^9}, {3.887233650116324*^9, 
   3.8872336563913813`*^9}, {3.8872337343342447`*^9, 3.887233780266137*^9}, {
   3.887233814338901*^9, 3.887233836122044*^9}, {3.88723389877948*^9, 
   3.887233920391522*^9}, 3.887239727973456*^9, {3.887239782440754*^9, 
   3.8872398174750547`*^9}},ExpressionUUID->"e3eeaa21-abbf-4276-b3cd-\
f68fbc49146a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Norm matrix is positive definite?  \"\>", "\[InvisibleSpace]", 
   "False"}],
  SequenceForm["Norm matrix is positive definite?  ", False],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887233861984989*^9, {3.887233899257906*^9, 3.887233921389894*^9}, 
   3.8872397289264927`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"28520b0b-4ffc-44ed-9c74-22dca0eb4e06"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Hamiltonian is hermitian?  \"\>", "\[InvisibleSpace]", "True"}],
  SequenceForm["Hamiltonian is hermitian?  ", True],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887233861984989*^9, {3.887233899257906*^9, 3.887233921389894*^9}, 
   3.887239728927433*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"6d94dd9e-de5c-4222-b276-0dc5fbfca2ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are complex eigenvalues?  \"\>", "\[InvisibleSpace]", 
   "True"}],
  SequenceForm["There are complex eigenvalues?  ", True],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887233861984989*^9, {3.887233899257906*^9, 3.887233921389894*^9}, 
   3.887239728927824*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"eeca70f2-8d34-44dc-93ba-0a0ad6ba6004"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigensystem", "[", "NorMat", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8872335616026783`*^9, 3.887233600800935*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"266f9b45-ee9d-4f55-922c-34605d3a412c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.09323690122101752`", ",", "5.786226575537523`*^-6", ",", 
   "3.907365417743291`*^-7", ",", "4.972174788925542`*^-8", ",", 
   "7.4472730155701`*^-9", ",", "9.634411977561805`*^-10", ",", 
   "1.0008557145511146`*^-10", ",", "8.592698321692155`*^-12", ",", 
   "6.247999398989896`*^-13", ",", "3.8963821439333765`*^-14", ",", 
   "2.0973392224140355`*^-15", ",", "9.629601234393272`*^-17", ",", 
   "3.965592964048082`*^-18", ",", "1.0686814932892544`*^-18", ",", 
   RowBox[{"-", "4.717961731550686`*^-19"}], ",", 
   RowBox[{"-", "4.36556598322991`*^-19"}], ",", "3.874625694588215`*^-19", 
   ",", 
   RowBox[{"-", "2.5986049649184725`*^-20"}], ",", 
   RowBox[{"-", "2.2209614017383528`*^-20"}], ",", "1.8297111179520768`*^-20",
    ",", "1.3853370013874035`*^-20", ",", 
   RowBox[{"-", "1.0204324815789854`*^-20"}], ",", 
   RowBox[{"-", "7.931032949873273`*^-21"}], ",", 
   RowBox[{"-", "5.1772593500629476`*^-21"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8872335722188587`*^9, 3.8872336013881483`*^9}, 
   3.887233828261331*^9, 3.887233871525942*^9, {3.887233906822464*^9, 
   3.887233930250195*^9}},
 CellLabel->
  "Out[179]=",ExpressionUUID->"0221251a-d7b3-44ba-87fe-4efffb7d5f82"]
}, Open  ]]
},
WindowSize->{960., 1052.25},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"88bf273d-8f0b-40d5-84b4-f0a189fded9e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1087, 25, 71, "Input",ExpressionUUID->"cf04348f-7816-4b2f-8ae2-b22df846011d"],
Cell[1670, 49, 247, 3, 33, "Output",ExpressionUUID->"57912313-619e-41a3-8f5e-85e5da2914ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1954, 57, 4205, 83, 211, "Input",ExpressionUUID->"35efcf03-bbc1-49e6-a283-337798143983",
 InitializationCell->True],
Cell[6162, 142, 808, 12, 23, "Print",ExpressionUUID->"2e00cec1-fdf5-4999-996c-304d05284fb4"]
}, Open  ]],
Cell[6985, 157, 2344, 66, 90, "Input",ExpressionUUID->"2bc62ebd-0e32-4e49-a5c6-4cabc9396e9a",
 InitializationCell->True],
Cell[9332, 225, 5967, 117, 173, "Input",ExpressionUUID->"5a238007-b3e1-452b-8b3b-7c130bd86630",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15324, 346, 5355, 139, 362, "Input",ExpressionUUID->"b4405cc3-3da0-4835-956c-ca9ff5f86c93"],
Cell[20682, 487, 395, 9, 22, "Message",ExpressionUUID->"72eb5e1f-ac13-47c6-b5ca-c74d30505530"],
Cell[21080, 498, 397, 9, 22, "Message",ExpressionUUID->"00605464-4b1d-4ee9-8876-c34c44d4e4c3"],
Cell[21480, 509, 508, 11, 22, "Message",ExpressionUUID->"d9e1d8ca-8d51-43c1-9610-bc861a2dd750"],
Cell[21991, 522, 508, 11, 22, "Message",ExpressionUUID->"9d4520a4-bcf8-49bf-8dbf-51d08fe76208"],
Cell[22502, 535, 511, 11, 22, "Message",ExpressionUUID->"72037f9e-6cc3-455a-bcfa-4dda04816b39"],
Cell[23016, 548, 508, 11, 22, "Message",ExpressionUUID->"821cc993-e2d0-4e72-af63-e746b63f8fc9"],
Cell[23527, 561, 510, 11, 22, "Message",ExpressionUUID->"1352a47d-be38-4208-b4d2-19d676012bdf"],
Cell[24040, 574, 509, 11, 22, "Message",ExpressionUUID->"a7dfda46-c376-41c7-a46f-22fe14b7f144"],
Cell[24552, 587, 642, 14, 33, "Output",ExpressionUUID->"13cdea2f-e73b-415b-bab2-6f9e9e0f89e5"],
Cell[25197, 603, 557, 12, 33, "Output",ExpressionUUID->"cd381f81-e5c5-45f2-9bf7-7e2fddd6c8e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25791, 620, 2932, 58, 174, "Input",ExpressionUUID->"e3eeaa21-abbf-4276-b3cd-f68fbc49146a"],
Cell[CellGroupData[{
Cell[28748, 682, 443, 11, 23, "Print",ExpressionUUID->"28520b0b-4ffc-44ed-9c74-22dca0eb4e06"],
Cell[29194, 695, 419, 10, 23, "Print",ExpressionUUID->"6d94dd9e-de5c-4222-b276-0dc5fbfca2ff"],
Cell[29616, 707, 433, 11, 23, "Print",ExpressionUUID->"eeca70f2-8d34-44dc-93ba-0a0ad6ba6004"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30098, 724, 271, 6, 29, "Input",ExpressionUUID->"266f9b45-ee9d-4f55-922c-34605d3a412c"],
Cell[30372, 732, 1240, 23, 99, "Output",ExpressionUUID->"0221251a-d7b3-44ba-87fe-4efffb7d5f82"]
}, Open  ]]
}
]
*)

