(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44387,        966]
NotebookOptionsPosition[     42377,        923]
NotebookOutlinePosition[     42821,        940]
CellTagsIndexPosition[     42778,        937]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"Off", "[", 
    RowBox[{
     StyleBox[
      RowBox[{"General", "::", "munfl"}], "MessageName"], 
     StyleBox[",", "MessageName"], 
     RowBox[{"FindFit", "::", "cvmit"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{
   StyleBox[
    RowBox[{"General", "::", "munfl"}], "MessageName"], 
   StyleBox[",", "MessageName"], 
   RowBox[{"General", "::", "stop"}], ",", 
   RowBox[{"LinearSolve", "::", "luc"}], ",", 
   RowBox[{"FindFit", "::", "cvmit"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8868099639307537`*^9, 3.886809971912171*^9}, {
  3.886810014351569*^9, 3.886810018457185*^9}, {3.8868100632171164`*^9, 
  3.8868100792173653`*^9}, {3.886810162920635*^9, 3.886810166963867*^9}, {
  3.886811555557131*^9, 3.8868115824505243`*^9}, {3.886811621708199*^9, 
  3.8868116566612797`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"cf04348f-7816-4b2f-8ae2-b22df846011d"],

Cell[BoxData["\<\"/home/johannesk/kette_repo/limit_cycles/src_mathematica/\
good_fits\"\>"], "Output",
 CellChangeTimes->{3.887513510200694*^9, 3.8875185086916513`*^9, 
  3.88751894354382*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"5448ef81-d223-4d20-a149-b1fc642ab85b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LECsNUCL", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<../LECs_nucl_Joki.dat\>\"", ",", "\"\<Table\>\""}], "]"}], 
     "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"activeLEC", "=", 
   RowBox[{"LECsNUCL", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", "=", "197.327053"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Mm", "=", "938.92"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m1", "=", 
   RowBox[{"2", " ", "Mm"}]}], ";", 
  RowBox[{"m2", "=", " ", "Mm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]", "=", 
   RowBox[{"m1", " ", 
    RowBox[{"m2", "/", 
     RowBox[{"(", 
      RowBox[{"m1", "+", "m2"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mh2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "Mm"}], ")"}], "/", 
    RowBox[{
     RowBox[{"(", "hbar", ")"}], "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"1", "/", "mh2"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.806896936913022*^9, 3.8068970008591266`*^9}, 
   3.806897170588989*^9, 3.8069185960989933`*^9, 3.828961525247902*^9, {
   3.82896195420479*^9, 3.828961958065777*^9}, 3.829047005911919*^9, 
   3.829049549313146*^9, 3.829050563497466*^9, {3.829111485536989*^9, 
   3.82911149275898*^9}, {3.829111954111908*^9, 3.8291119612539*^9}, {
   3.829112252140929*^9, 3.829112261893633*^9}, {3.829112573732985*^9, 
   3.829112651253894*^9}, {3.8291128337762623`*^9, 3.829112883724078*^9}, {
   3.829113166587775*^9, 3.8291131806499767`*^9}, {3.829113328957966*^9, 
   3.829113359441307*^9}, {3.829113389516396*^9, 3.829113421977861*^9}, 
   3.82911359058664*^9, {3.831020999626773*^9, 3.831021052854327*^9}, {
   3.831021137239236*^9, 3.831021161717834*^9}, {3.831021192429678*^9, 
   3.831021281026369*^9}, {3.831021336132536*^9, 3.831021437429002*^9}, {
   3.831032542266756*^9, 3.8310325557267437`*^9}, {3.834050512313829*^9, 
   3.834050517106021*^9}, {3.834050604750242*^9, 3.834050630559705*^9}, {
   3.834050750565744*^9, 3.83405077321001*^9}, {3.834050823224724*^9, 
   3.8340508902194643`*^9}, {3.834050957167952*^9, 3.834050973889583*^9}, {
   3.834052294530594*^9, 3.834052435905081*^9}, {3.83465332463794*^9, 
   3.8346534999392233`*^9}, {3.8357552237033463`*^9, 3.835755238065895*^9}, 
   3.835756956831279*^9, {3.835759112957494*^9, 3.8357591266674023`*^9}, {
   3.83575916390582*^9, 3.835759178021888*^9}, 3.83620997072495*^9, {
   3.83621035297618*^9, 3.836210429280836*^9}, {3.840523938427368*^9, 
   3.840524020511397*^9}, {3.840697378938952*^9, 3.840697451024289*^9}, {
   3.84137465740092*^9, 3.8413747378881598`*^9}, {3.8413747790104237`*^9, 
   3.8413747864186783`*^9}, {3.841374848538939*^9, 3.841374849132146*^9}, {
   3.841374890194478*^9, 3.841374964797176*^9}, 3.841375120156419*^9, {
   3.841375263998637*^9, 3.8413753719531593`*^9}, {3.841375402268126*^9, 
   3.841375402827441*^9}, {3.841375468144746*^9, 3.8413755600898323`*^9}, {
   3.855570823759363*^9, 3.855570831337441*^9}, 3.855571422722322*^9, {
   3.855651207266287*^9, 3.855651235174877*^9}, {3.855722420660387*^9, 
   3.855722425128508*^9}, {3.8603765100850153`*^9, 3.860376518611704*^9}, 
   3.860376579439577*^9, {3.875072442974223*^9, 3.875072573691984*^9}, {
   3.876266776807109*^9, 3.876266829985648*^9}, 3.876980116419195*^9, {
   3.876980157396861*^9, 3.876980179743556*^9}, 3.8769817535983562`*^9, {
   3.881214732169114*^9, 3.881214818255166*^9}, 3.881214867434598*^9, 
   3.881651217243663*^9, {3.881651265148467*^9, 3.881651269548263*^9}, {
   3.881730031418*^9, 3.881730078791593*^9}, 3.885429718807684*^9, {
   3.885429769971409*^9, 3.885429779421628*^9}, {3.8859733632464952`*^9, 
   3.8859733996630163`*^9}, {3.886381243492303*^9, 3.886381274477777*^9}, 
   3.887152593397892*^9, {3.887152636956827*^9, 3.887152651253252*^9}, {
   3.887232970029624*^9, 3.887232970189232*^9}, {3.8872462579417257`*^9, 
   3.887246273793933*^9}, {3.8872463435443907`*^9, 3.887246348541093*^9}, {
   3.887255476169883*^9, 3.887255478288437*^9}, {3.8872856275672493`*^9, 
   3.887285647553644*^9}, 3.887323884258789*^9, {3.887518683357769*^9, 
   3.887518683599318*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"35efcf03-bbc1-49e6-a283-337798143983"],

Cell[BoxData["20.73550773530482`"], "Print",
 CellChangeTimes->{{3.887152805661826*^9, 3.8871528073072433`*^9}, {
   3.8871531130570593`*^9, 3.887153114695756*^9}, {3.887153194504979*^9, 
   3.8871531960699053`*^9}, 3.8871537005029793`*^9, 3.887154010149467*^9, {
   3.887154057524427*^9, 3.887154059147504*^9}, {3.887154133150298*^9, 
   3.887154134664267*^9}, 3.88715417411154*^9, {3.8871542279975357`*^9, 
   3.887154252140561*^9}, {3.8871545202186737`*^9, 3.887154521793107*^9}, {
   3.887154593483242*^9, 3.887154663498577*^9}, {3.887154738856539*^9, 
   3.887154788235956*^9}, 3.88715484020175*^9, {3.8872326439466333`*^9, 
   3.887232719696145*^9}, {3.887232959112103*^9, 3.887232970697383*^9}, 
   3.887246279892552*^9, {3.8872463525761623`*^9, 3.8872463572988787`*^9}, 
   3.8872464859196253`*^9, 3.8872465717631702`*^9, {3.887246629328568*^9, 
   3.887246647795085*^9}, 3.887246698364727*^9, 3.887246763662887*^9, 
   3.887246803684424*^9, 3.88724684839263*^9, 3.887246959377761*^9, 
   3.887250355153097*^9, {3.887253271155901*^9, 3.887253294523869*^9}, 
   3.887253812284259*^9, 3.8872539327419653`*^9, {3.88725397708628*^9, 
   3.8872539786963463`*^9}, 3.8872540784690123`*^9, 3.887254145453336*^9, 
   3.8872554884946957`*^9, 3.887255831919633*^9, 3.887267379753531*^9, {
   3.887267420068906*^9, 3.8872674333915462`*^9}, {3.8872675103478622`*^9, 
   3.887267512103073*^9}, {3.887267663885126*^9, 3.8872676868607283`*^9}, 
   3.88728487060594*^9, {3.8872849065770683`*^9, 3.887284908221035*^9}, {
   3.887285371028369*^9, 3.887285394078006*^9}, 3.887285483005953*^9, {
   3.88728563255812*^9, 3.8872856540605097`*^9}, {3.88732392176789*^9, 
   3.8873239485944757`*^9}, 3.887324145603633*^9, 3.887325692749819*^9, {
   3.887325788927926*^9, 3.887325791278372*^9}, {3.887326873249909*^9, 
   3.88732697088931*^9}, 3.887327018811678*^9, {3.887327059603978*^9, 
   3.887327072362507*^9}, {3.887340945665922*^9, 3.8873409474338217`*^9}, 
   3.88734101716611*^9, {3.8873418583880577`*^9, 3.887341877997052*^9}, 
   3.887342166199409*^9, {3.887345457307301*^9, 3.8873454770175037`*^9}, 
   3.887345578871018*^9, {3.887345712208392*^9, 3.887345713897767*^9}, {
   3.887345770154971*^9, 3.887345790213249*^9}, {3.887354631990377*^9, 
   3.887354661701067*^9}, 3.887354716184416*^9, {3.887354748152563*^9, 
   3.887354793741889*^9}, {3.887354831390217*^9, 3.8873548442363443`*^9}, 
   3.887354876742422*^9, {3.887354920132145*^9, 3.887354994129115*^9}, {
   3.887355350827323*^9, 3.887355364964589*^9}, {3.887355396524104*^9, 
   3.887355432657411*^9}, 3.887355463248024*^9, {3.8873555776652403`*^9, 
   3.887355623106119*^9}, 3.887355704634473*^9, 3.887355901119223*^9, {
   3.887357426231928*^9, 3.8873574537774267`*^9}, 3.8874051049188623`*^9, 
   3.88740551569556*^9, {3.8874057087113943`*^9, 3.8874057102631893`*^9}, {
   3.887405743505701*^9, 3.8874057450536127`*^9}, {3.887406019715744*^9, 
   3.8874060212743387`*^9}, {3.8874060693374643`*^9, 
   3.8874060937553663`*^9}, {3.887407807519331*^9, 3.8874078643040657`*^9}, {
   3.887407991814219*^9, 3.887408055378228*^9}, 3.887425590173441*^9, 
   3.887425664506325*^9, {3.887425802060611*^9, 3.8874258171405077`*^9}, {
   3.887425866600953*^9, 3.887425868991645*^9}, 3.887425917767735*^9, {
   3.8874262190726633`*^9, 3.887426239290429*^9}, 3.887426280030232*^9, {
   3.8874309375631104`*^9, 3.887430968988339*^9}, {3.887431026627359*^9, 
   3.8874310283526793`*^9}, {3.887436937865261*^9, 3.887436984976222*^9}, 
   3.887437017149909*^9, {3.887437047603644*^9, 3.8874370491850643`*^9}, 
   3.8874371060136347`*^9, {3.887437188432872*^9, 3.887437190093945*^9}, 
   3.887509348472966*^9, {3.887513508567523*^9, 3.887513510283918*^9}, 
   3.887518508712078*^9, {3.887518928878931*^9, 3.887518944309276*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"f4f01b11-fb9a-4aaf-a344-d38ebd9690e4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"I1", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Pi", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "b1"}], "+", 
        RowBox[{"2", "b2"}], "+", 
        RowBox[{"lam", "^", "2"}]}], ")"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"3", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I2", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], " ", ":=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I3", "[", 
    RowBox[{"b1_", ",", "b2_"}], "]"}], " ", ":=", 
   RowBox[{"3", " ", "b1", " ", "b2", " ", 
    RowBox[{
     RowBox[{"Pi", "^", 
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b1", "+", "b2"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"5", "/", "2"}], ")"}]}]}], ")"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.886826045644166*^9, 3.886826353984159*^9}, {
   3.886826842577756*^9, 3.8868271013364153`*^9}, {3.886827139203668*^9, 
   3.886827160933782*^9}, {3.886827195769246*^9, 3.886827300449576*^9}, {
   3.886827709276452*^9, 3.886827709622191*^9}, {3.886833040491798*^9, 
   3.886833056881873*^9}, {3.886833189037633*^9, 3.886833196683869*^9}, 
   3.8868341910945473`*^9, {3.887152115289495*^9, 3.887152186706695*^9}, {
   3.8871522610148706`*^9, 3.887152371115266*^9}, {3.887241742375197*^9, 
   3.887241786024472*^9}, {3.887255827725595*^9, 3.887255828381431*^9}, {
   3.887267355273036*^9, 3.887267374295113*^9}, {3.887267638420114*^9, 
   3.887267660004258*^9}, {3.8872825102607107`*^9, 3.8872825108926477`*^9}, 
   3.887282598874202*^9, {3.887285343471439*^9, 3.8872853530543203`*^9}, {
   3.8873238463485727`*^9, 3.8873238560437927`*^9}, {3.887323916897663*^9, 
   3.887323917453588*^9}, {3.887325588902899*^9, 3.887325683068941*^9}, {
   3.8873266765309896`*^9, 3.88732674721253*^9}, 3.887326861671508*^9, {
   3.887340756483328*^9, 3.887340894004004*^9}, {3.8873546468707952`*^9, 
   3.8873546510847893`*^9}, {3.88735474472827*^9, 3.8873547449520283`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"2bc62ebd-0e32-4e49-a5c6-4cabc9396e9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", 
    RowBox[{"lam_", ",", "b1_", ",", "b2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"locall", "=", "lam"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LECc", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"activeLEC", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "locall"}], "&"}]}],
           "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LECd", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"activeLEC", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "locall"}], "&"}]}],
           "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LECc", " ", 
        RowBox[{"I1", "[", 
         RowBox[{"lam", ",", "b1", ",", "b2"}], "]"}]}], "+", 
       RowBox[{"LECd", " ", 
        RowBox[{"I2", "[", 
         RowBox[{"lam", ",", "b1", ",", "b2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "mh2"}], ")"}], 
        RowBox[{"I3", "[", 
         RowBox[{"b1", ",", "b2"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", 
    RowBox[{"b1_", ",", "b2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "b1"}], "+", 
          RowBox[{"2", "b2"}]}], ")"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "  ", ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852262297124173*^9, 3.852262297124173*^9}, 
   3.8522626678443975`*^9, 3.8532267951977344`*^9, 3.853227124588494*^9, {
   3.853230498909873*^9, 3.853230519102766*^9}, {3.85323056358375*^9, 
   3.853230689577078*^9}, {3.8532308705205493`*^9, 3.8532308712537766`*^9}, 
   3.853231048818413*^9, 3.853231289893648*^9, {3.853298625530425*^9, 
   3.853298637683942*^9}, {3.8533002735976334`*^9, 3.8533002887755575`*^9}, {
   3.8533014821443253`*^9, 3.8533014858587027`*^9}, {3.8535226285993876`*^9, 
   3.8535226316622157`*^9}, 3.854895908307124*^9, 3.8548960211506567`*^9, {
   3.855229248986372*^9, 3.855229290007184*^9}, {3.855309712787837*^9, 
   3.855309717662904*^9}, {3.855311481860064*^9, 3.855311483768371*^9}, {
   3.855650771146367*^9, 3.855650852916173*^9}, {3.855739954296426*^9, 
   3.855739959539967*^9}, {3.8562617195048323`*^9, 3.856261744633113*^9}, {
   3.856263303436569*^9, 3.856263310396605*^9}, {3.8564314772238827`*^9, 
   3.856431487196451*^9}, {3.856431538535982*^9, 3.85643154245259*^9}, {
   3.8564315953330593`*^9, 3.85643160274969*^9}, 3.85643165797653*^9, {
   3.856431708992791*^9, 3.856431712106429*^9}, {3.8564318010960493`*^9, 
   3.856431805782648*^9}, {3.8565159742883387`*^9, 3.85651597750677*^9}, {
   3.875072644709866*^9, 3.87507275343948*^9}, {3.875072816418131*^9, 
   3.875072904761282*^9}, {3.875073151014079*^9, 3.875073155787969*^9}, {
   3.875073358726117*^9, 3.8750733611864233`*^9}, {3.87507348671796*^9, 
   3.8750734972629223`*^9}, {3.875073643186861*^9, 3.8750736530067053`*^9}, {
   3.875073690076045*^9, 3.875073773305233*^9}, {3.87507382416695*^9, 
   3.8750739575666447`*^9}, {3.875074000848612*^9, 3.875074004687408*^9}, {
   3.8750740375920963`*^9, 3.875074039838542*^9}, {3.8750740714123383`*^9, 
   3.875074080840233*^9}, {3.875084271891074*^9, 3.875084273119851*^9}, {
   3.875685291100933*^9, 3.875685341272833*^9}, {3.875685411682775*^9, 
   3.8756854139141912`*^9}, {3.8756856451720467`*^9, 3.875685658703032*^9}, 
   3.8756858077492237`*^9, {3.8769808456831083`*^9, 3.876980874393066*^9}, {
   3.8769809069774218`*^9, 3.876981035163525*^9}, {3.876981121311613*^9, 
   3.876981139396195*^9}, {3.8769811908095713`*^9, 3.8769812420744677`*^9}, {
   3.876981345227887*^9, 3.876981364082205*^9}, {3.876981450540691*^9, 
   3.8769814588597937`*^9}, {3.8769815386121817`*^9, 
   3.8769815395085297`*^9}, {3.87698167153968*^9, 3.87698167657003*^9}, {
   3.876981802133235*^9, 3.876981862925025*^9}, {3.876982027191504*^9, 
   3.876982092725515*^9}, {3.881653235263174*^9, 3.881653236840893*^9}, {
   3.885440719685811*^9, 3.8854407289682913`*^9}, {3.88544082518581*^9, 
   3.885440827437736*^9}, {3.88544289250159*^9, 3.885442893633552*^9}, {
   3.885893396609612*^9, 3.885893397594534*^9}, {3.8868276032541437`*^9, 
   3.886827619151113*^9}, {3.886827785316635*^9, 3.8868277989585342`*^9}, 
   3.88682798956781*^9, {3.886828019890383*^9, 3.88682806893468*^9}, {
   3.8868281120814047`*^9, 3.8868281176022367`*^9}, {3.886828207283139*^9, 
   3.8868282695077257`*^9}, 3.886828731025165*^9, {3.88682881717493*^9, 
   3.886828845104453*^9}, 3.886828876929533*^9, {3.88683307544916*^9, 
   3.8868332416217833`*^9}, {3.886834259488212*^9, 3.8868343578175383`*^9}, {
   3.8868344487445183`*^9, 3.886834479317075*^9}, {3.886834687383222*^9, 
   3.8868347084492197`*^9}, {3.88715243425797*^9, 3.887152466710951*^9}, {
   3.887152502594434*^9, 3.887152547346854*^9}, {3.88715309612043*^9, 
   3.887153099736305*^9}, {3.887153145483*^9, 3.887153176631443*^9}, {
   3.8871536456548357`*^9, 3.887153654729186*^9}, {3.887232625765098*^9, 
   3.887232639974882*^9}, 3.8872344168955507`*^9, {3.887239711597486*^9, 
   3.887239717081791*^9}, 3.8872403604387913`*^9, {3.8872407736145067`*^9, 
   3.8872407926430073`*^9}, {3.887240967434401*^9, 3.887240980873095*^9}, {
   3.8872410969761267`*^9, 3.887241097722733*^9}, {3.887241775658828*^9, 
   3.887241904621726*^9}, {3.887246954613312*^9, 3.887246955832902*^9}, {
   3.887255030352744*^9, 3.887255039257719*^9}, {3.887255370988463*^9, 
   3.8872553809427757`*^9}, 3.887285449656996*^9, {3.887326868047944*^9, 
   3.887326869028698*^9}, {3.887340904406061*^9, 3.887340935992075*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"5a238007-b3e1-452b-8b3b-7c130bd86630"],

Cell[TextData[{
 "dimD:  bare basis dimension\nwidths: educated guess for the Gaussian width \
parameters each of which defines a bare basis function  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], 
     RowBox[{"\[Sum]", 
      SuperscriptBox[
       OverscriptBox["r", "_"], "2"]}]}]], TraditionalForm]],ExpressionUUID->
  "fa52e2ac-46e3-43d7-9f42-2d7298231adf"],
 "\nlamd: cutoff/regularization parameter of the interaction\nevlowthreshold: \
empirically determined threshold which sets the lower bound for the norm \
eigenvalues that are allowed in the\n                                   \
stable, reduced basis"
}], "Text",
 CellChangeTimes->{{3.887243048772503*^9, 
  3.887243279417438*^9}},ExpressionUUID->"269e7c8d-2cf8-4c63-89c4-\
007a731f559b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimD", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"increments_", ",", 
     RowBox[{"start_", "?", "Positive"}], ",", 
     RowBox[{"end_", "?", "Positive"}]}], "]"}], ":=", 
   RowBox[{"Exp", "@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Log", "@", "start"}], ",", 
      RowBox[{"Log", "@", "end"}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"end", "/", "start"}], "]"}], "/", "increments"}]}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"widths", " ", "=", " ", 
    RowBox[{"N", "@", 
     RowBox[{"logspace", "[", 
      RowBox[{"dimD", ",", ".001", ",", "30.08"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"widths", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.5"}], "}"}], ",", "dimD"}], "]"}]}], ";"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"lamd", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evlowthreshold", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hamm", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ham", "[", 
       RowBox[{"lamd", ",", 
        RowBox[{"widths", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"widths", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dimD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dimD"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normm", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"norm", "[", 
       RowBox[{
        RowBox[{"widths", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"widths", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dimD"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dimD"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normDiag", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"1.", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Diagonal", "[", "normm", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HamN", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "normDiag", "]"}], ".", "hamm"}], ")"}], ".", 
    "normDiag"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormN", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "normDiag", "]"}], ".", "normm"}], ")"}], ".",
     "normDiag"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"esn", "=", 
    RowBox[{"Eigensystem", "[", "NormN", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "norm", " ", "eigensystem", " ", "in", " ", "descending", " ", 
    "eigenvalue", " ", "order"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "esn", "]"}], " ", "yields", " ", "a", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["Evalue", "1"], ",", 
        RowBox[{"{", 
         SubscriptBox["Evector", "1"], "}"}]}], "}"}], ",", "...", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["Evalue", "N"], ",", 
        RowBox[{"{", 
         SubscriptBox["Evector", "N"], "}"}]}], "}"}]}], "}"}], " ", "list"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Mu]", ",", "transf"}], "}"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "esn", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ">", "evlowthreshold"}], "&"}]}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "transformation", " ", "such", " ", "that", " ", "norm", 
    " ", "matrix", " ", "in", " ", "this", " ", "basis", " ", "is", " ", 
    "the", " ", "unit", " ", "matrix", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trafma", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "transf", "]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       SuperscriptBox["\[Mu]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"transfrom", " ", "Hamiltonian"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traham", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", "trafma", "]"}], ".", "HamN"}], ")"}], ".", 
     "trafma"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Dim - \!\(\*SubscriptBox[\(Dim\), \(reduced\)]\) = \>\"", ",", "dimD",
     ",", "\"\< - \>\"", ",", 
    RowBox[{"Length", "[", "\[Mu]", "]"}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "diagonalize", " ", "the", " ", "Hamiltonian", " ", "in", " ", "the", " ", 
    "new", " ", "basis"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esh", "=", 
   RowBox[{"Eigensystem", "[", "traham", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "transfe"}], "}"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "esh", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "extract", " ", "the", " ", "expansion", " ", "coefficients", " ", "of", 
    " ", "the", " ", "ground", " ", "state", " ", "in", " ", "terms", " ", 
    "of", " ", "the", " ", "new", " ", "basis", " ", "vectors"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gsh", "=", 
   RowBox[{"transfe", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*TemplateBox[{\"0\"},\"Bra\"]\)H\!\(\*TemplateBox[{\"0\"},\"Ket\"\
]\) = \>\"", ",", 
    RowBox[{"gsh", ".", "traham", ".", "gsh"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "obtain", " ", "the", " ", "expansion", " ", "coefficients", " ", "of", 
    " ", "the", " ", "ground", " ", "state", " ", "in", " ", "terms", " ", 
    "of", " ", "the", " ", "old", " ", "basis", " ", "vectors", 
    "\[IndentingNewLine]", 
    RowBox[{"ECCE", ":", " ", 
     RowBox[{
     "these", " ", "coefficients", " ", "are", " ", "different", " ", "from", 
      " ", "the", " ", "ones", " ", "which", " ", "a", " ", "straigtforward", 
      " ", "diag", " ", "in", " ", "the", " ", "old", "\[IndentingNewLine]", 
      "basis", " ", "vields"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\!\(\*TemplateBox[{\"0\"},\"Ket\"]\)=\!\(\*SubsuperscriptBox[\(\[Sum]\)\
, \(i = 1\), \(N\)]\)\!\(\*SubscriptBox[\(g\), \(i\)]\)\!\(\*TemplateBox[{\"i\
\"},\"Ket\"]\) with\\n \!\(\*SubscriptBox[\(g\), \(i\)]\) = \
\!\(\*SuperscriptBox[\(S\), \
\(T\)]\)\[CenterDot]\!\(\*SuperscriptBox[OverscriptBox[\(c\), \
\(\[RightVector]\)], \((0)\)]\) =\>\"", ",", 
   RowBox[{"trafma", ".", "gsh"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886833265645858*^9, 3.886833271762014*^9}, {
   3.886833339323434*^9, 3.8868333494527407`*^9}, {3.886834639486484*^9, 
   3.8868346678908863`*^9}, {3.8868358804544907`*^9, 3.886835884654442*^9}, {
   3.886836783624535*^9, 3.8868367853711576`*^9}, {3.8868369030213537`*^9, 
   3.8868369272566967`*^9}, {3.886837012469288*^9, 3.886837013099429*^9}, 
   3.887152092396377*^9, {3.88715220673015*^9, 3.887152207358666*^9}, {
   3.8871525601993837`*^9, 3.887152561513832*^9}, {3.887152786553145*^9, 
   3.887152800283319*^9}, 3.88715366167279*^9, {3.8871539699742393`*^9, 
   3.8871540050222588`*^9}, 3.8871540455695877`*^9, {3.88715410303461*^9, 
   3.887154109020401*^9}, 3.887154166460936*^9, {3.887154204294366*^9, 
   3.8871542486046124`*^9}, {3.887154293674049*^9, 3.88715432669934*^9}, {
   3.887154402744279*^9, 3.887154419000801*^9}, {3.88715447450237*^9, 
   3.887154495719109*^9}, {3.887154560879056*^9, 3.8871545878559113`*^9}, {
   3.8871546226354017`*^9, 3.887154641742457*^9}, {3.887154717615881*^9, 
   3.8871547737432957`*^9}, {3.887232677174582*^9, 3.88723270547806*^9}, {
   3.887232837887662*^9, 3.887232838210527*^9}, {3.887232981178138*^9, 
   3.887233101222*^9}, {3.887233231722543*^9, 3.887233436270741*^9}, {
   3.8872334784659567`*^9, 3.88723349763164*^9}, {3.887233650116324*^9, 
   3.8872336563913813`*^9}, {3.8872337343342447`*^9, 3.887233780266137*^9}, {
   3.887233814338901*^9, 3.887233836122044*^9}, {3.88723389877948*^9, 
   3.887233920391522*^9}, 3.887239727973456*^9, {3.887239782440754*^9, 
   3.8872399862650833`*^9}, {3.887240029214909*^9, 3.887240044889618*^9}, {
   3.887240081953562*^9, 3.887240331861792*^9}, {3.887240415968219*^9, 
   3.887240421534067*^9}, {3.887240802221437*^9, 3.887240887674721*^9}, {
   3.887240948772334*^9, 3.88724095388627*^9}, {3.887240990587707*^9, 
   3.887241001670182*^9}, {3.8872411137094393`*^9, 3.887241142511423*^9}, {
   3.887241676239867*^9, 3.8872417234605427`*^9}, {3.887241916007595*^9, 
   3.887241954147134*^9}, {3.887243026690815*^9, 3.8872430452466097`*^9}, {
   3.887243294179998*^9, 3.887243322229252*^9}, {3.887243529503199*^9, 
   3.8872436059220448`*^9}, {3.8872437465242033`*^9, 3.887243898480823*^9}, {
   3.887246800223516*^9, 3.887246800647356*^9}, 3.887246844259296*^9, 
   3.887250352598741*^9, {3.887253264293005*^9, 3.8872532915143948`*^9}, 
   3.8872539289842176`*^9, {3.887254703625969*^9, 3.887254704749776*^9}, 
   3.8872547427415533`*^9, {3.8872559214649773`*^9, 3.887256009702478*^9}, {
   3.887267415638898*^9, 3.88726741639843*^9}, 3.887324142354569*^9, {
   3.887326906785365*^9, 3.8873269681456537`*^9}, {3.8873270100081882`*^9, 
   3.8873270122565317`*^9}, {3.8873270558053503`*^9, 3.8873270693375807`*^9}, 
   3.887340567416725*^9, {3.887341011166748*^9, 3.887341013196581*^9}, {
   3.887341846823061*^9, 3.88734196178336*^9}, 3.887342163051611*^9, {
   3.887342467341238*^9, 3.887342528986092*^9}, {3.887342577563313*^9, 
   3.8873426011551113`*^9}, {3.887345451527502*^9, 3.887345508724695*^9}, {
   3.887345563171845*^9, 3.8873455728231783`*^9}, 3.887345654373304*^9, {
   3.887345701955551*^9, 3.88734570537433*^9}, {3.8873457638830023`*^9, 
   3.887345872668832*^9}, {3.887345904126061*^9, 3.887345933422042*^9}, {
   3.8873460297824993`*^9, 3.887346052208234*^9}, {3.8873461082265453`*^9, 
   3.8873461088190928`*^9}, {3.887346146032523*^9, 3.887346266408677*^9}, {
   3.887346303320511*^9, 3.887346428506352*^9}, 3.887346485564502*^9, {
   3.887346518461*^9, 3.887346553410508*^9}, 3.887354622776587*^9, {
   3.887354761865521*^9, 3.887354790743225*^9}, {3.887354827480926*^9, 
   3.8873548735598917`*^9}, {3.887354913634412*^9, 3.887354932286152*^9}, 
   3.887354967809737*^9, {3.8873553448983727`*^9, 3.8873554591274023`*^9}, {
   3.8873555144583693`*^9, 3.887355620517396*^9}, {3.887355662719467*^9, 
   3.887355687197198*^9}, {3.887355890390527*^9, 3.887355897542794*^9}, {
   3.887357422646842*^9, 3.887357450712056*^9}, {3.887357896820602*^9, 
   3.887357906326455*^9}, 3.887358027840104*^9, {3.8874051009543943`*^9, 
   3.887405122301874*^9}, {3.8874054435355463`*^9, 3.8874055092949142`*^9}, 
   3.887405728287064*^9, 3.887405809947238*^9, {3.887405896777356*^9, 
   3.887405933607078*^9}, {3.887405982205606*^9, 3.887406006661335*^9}, {
   3.887406065212816*^9, 3.8874060900720253`*^9}, {3.887407802947488*^9, 
   3.8874079881426973`*^9}, {3.8874080433775997`*^9, 
   3.8874080507840033`*^9}, {3.887409086447049*^9, 3.887409111360179*^9}, {
   3.887409234423967*^9, 3.887409235874715*^9}, {3.887409326075363*^9, 
   3.887409330584223*^9}, {3.8874240818996468`*^9, 3.8874240879103613`*^9}, {
   3.887425579190199*^9, 3.887425583216805*^9}, {3.8874256603796597`*^9, 
   3.887425661844923*^9}, {3.88742578915108*^9, 3.887425852995607*^9}, 
   3.887425913791114*^9, {3.887426165199645*^9, 3.887426171515449*^9}, {
   3.8874262162856817`*^9, 3.887426225586131*^9}, {3.887426267911573*^9, 
   3.887426275901785*^9}, {3.887430917772563*^9, 3.887430954798568*^9}, {
   3.887430987155218*^9, 3.887430998114551*^9}, {3.88743210627388*^9, 
   3.887432114379408*^9}, 3.887432144412669*^9, {3.887436907989945*^9, 
   3.887437060349744*^9}, {3.887437102983053*^9, 3.8874371032693768`*^9}, {
   3.887437137935631*^9, 3.8874371826101923`*^9}, {3.887437263584386*^9, 
   3.88743733632763*^9}, {3.887437616275537*^9, 3.887437624008315*^9}, 
   3.887437660702817*^9, {3.887437695622068*^9, 3.8874378261445417`*^9}, {
   3.887437870322783*^9, 3.887437876627068*^9}, {3.887437911855378*^9, 
   3.8874379785266314`*^9}, 3.887438020539578*^9, {3.887438072327448*^9, 
   3.887438073294684*^9}, {3.8874397874947*^9, 3.887439796794367*^9}, {
   3.8874414207759733`*^9, 3.887441458794559*^9}, {3.887441520549059*^9, 
   3.8874415450956984`*^9}, 3.887444078304235*^9, 3.887444136597899*^9, {
   3.887509339465728*^9, 3.887509358261579*^9}, {3.887509458061607*^9, 
   3.88750961633149*^9}, {3.887509841182232*^9, 3.887509868943404*^9}, {
   3.887509904867186*^9, 3.887509934644566*^9}, {3.887509995122974*^9, 
   3.887510008903034*^9}, {3.887510039731399*^9, 3.88751010100494*^9}, {
   3.88751014656662*^9, 3.887510170710682*^9}, {3.88751268965779*^9, 
   3.887512699229041*^9}, {3.887513014804652*^9, 3.887513041312024*^9}, {
   3.887513071725881*^9, 3.887513142864773*^9}, {3.887513200272643*^9, 
   3.887513203234877*^9}, {3.887513246703774*^9, 3.887513247835322*^9}, {
   3.8875134076500263`*^9, 3.887513427546671*^9}, {3.887513474509243*^9, 
   3.887513492946824*^9}, {3.887513524164721*^9, 3.887513553860424*^9}, {
   3.887518501561287*^9, 3.8875185149138937`*^9}, {3.887518793478118*^9, 
   3.887518925267386*^9}, {3.887518980501712*^9, 3.88751908070154*^9}, {
   3.88751924069913*^9, 3.887519544288211*^9}, {3.887519577307145*^9, 
   3.88751960674774*^9}, {3.887521195620523*^9, 3.887521396638433*^9}, {
   3.887521507011016*^9, 3.887521642770699*^9}, {3.8875236180386677`*^9, 
   3.887523772528735*^9}, {3.887523866646665*^9, 3.8875239615640697`*^9}, {
   3.887523998739002*^9, 3.8875240143800097`*^9}, {3.8875241438344803`*^9, 
   3.88752422931118*^9}, {3.887524282519884*^9, 3.8875244872481737`*^9}, {
   3.887524523413041*^9, 3.8875247488691998`*^9}, {3.8875248059264927`*^9, 
   3.887524842316866*^9}, {3.8875248957870617`*^9, 3.887524953542542*^9}, 
   3.887525224983317*^9},
 CellLabel->
  "In[1080]:=",ExpressionUUID->"b4405cc3-3da0-4835-956c-ca9ff5f86c93"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Dim - \\!\\(\\*SubscriptBox[\\(Dim\\), \\(reduced\\)]\\) = \
\"\>", "\[InvisibleSpace]", "4", "\[InvisibleSpace]", "\<\" - \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Dim - \!\(\*SubscriptBox[\(Dim\), \(reduced\)]\) = ", 4, " - ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887524582782475*^9, {3.8875247382825603`*^9, 3.887524749473172*^9}, 
   3.8875248063188057`*^9, {3.8875248429020576`*^9, 3.887524863714226*^9}, {
   3.8875249469695263`*^9, 3.887524954241954*^9}, 3.887525225389881*^9},
 CellLabel->
  "During evaluation of \
In[1080]:=",ExpressionUUID->"b7718fbd-8136-4639-90c8-b62214262d7d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*TemplateBox[{\\\"0\\\"},\\\"Bra\\\"]\\)H\\!\\(\\*\
TemplateBox[{\\\"0\\\"},\\\"Ket\\\"]\\) = \"\>", "\[InvisibleSpace]", 
   "0.060333893378483966`"}],
  SequenceForm[
  "\!\(\*TemplateBox[{\"0\"},\"Bra\"]\)H\!\(\*TemplateBox[{\"0\"},\"Ket\"]\) \
= ", 0.060333893378483966`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887524582782475*^9, {3.8875247382825603`*^9, 3.887524749473172*^9}, 
   3.8875248063188057`*^9, {3.8875248429020576`*^9, 3.887524863714226*^9}, {
   3.8875249469695263`*^9, 3.887524954241954*^9}, 3.88752522539045*^9},
 CellLabel->
  "During evaluation of \
In[1080]:=",ExpressionUUID->"38567fd7-b0d2-4a57-8a7a-31c27e511c49"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*TemplateBox[{\\\"0\\\"},\\\"Ket\\\"]\\)=\\!\\(\\*\
SubsuperscriptBox[\\(\[Sum]\\), \\(i = 1\\), \
\\(N\\)]\\)\\!\\(\\*SubscriptBox[\\(g\\), \\(i\\)]\\)\\!\\(\\*TemplateBox[{\\\
\"i\\\"},\\\"Ket\\\"]\\) with\\n \\!\\(\\*SubscriptBox[\\(g\\), \\(i\\)]\\) = \
\\!\\(\\*SuperscriptBox[\\(S\\), \
\\(T\\)]\\)\[CenterDot]\\!\\(\\*SuperscriptBox[OverscriptBox[\\(c\\), \\(\
\[RightVector]\\)], \\((0)\\)]\\) =\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1.0056793035799192`", ",", 
     RowBox[{"-", "0.016716803292138704`"}], ",", "0.00527730272783794`", ",",
      "0.0031456009792496242`"}], "}"}]}],
  SequenceForm[
  "\!\(\*TemplateBox[{\"0\"},\"Ket\"]\)=\!\(\*SubsuperscriptBox[\(\[Sum]\), \
\(i = 1\), \(N\)]\)\!\(\*SubscriptBox[\(g\), \
\(i\)]\)\!\(\*TemplateBox[{\"i\"},\"Ket\"]\) with\n \!\(\*SubscriptBox[\(g\), \
\(i\)]\) = \!\(\*SuperscriptBox[\(S\), \
\(T\)]\)\[CenterDot]\!\(\*SuperscriptBox[OverscriptBox[\(c\), \
\(\[RightVector]\)], \((0)\)]\) =", {
   1.0056793035799192`, -0.016716803292138704`, 0.00527730272783794, 
   0.0031456009792496242`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.887524582782475*^9, {3.8875247382825603`*^9, 3.887524749473172*^9}, 
   3.8875248063188057`*^9, {3.8875248429020576`*^9, 3.887524863714226*^9}, {
   3.8875249469695263`*^9, 3.887524954241954*^9}, 3.887525225391037*^9},
 CellLabel->
  "During evaluation of \
In[1080]:=",ExpressionUUID->"ce9e6c48-5183-4604-8ebb-e53a4ae45583"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"esbare", "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"{", 
     RowBox[{"hamm", ",", "normm"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Epsilon]b", ",", "transfeb"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "esbare", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"gsbare", "=", 
  RowBox[{"transfeb", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "All"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\!\(\*TemplateBox[{\"0\"},\"Bra\"]\)H\!\(\*TemplateBox[{\"0\"},\"Ket\"]\
\) = \>\"", ",", 
   RowBox[{
    RowBox[{"gsbare", ".", "hamm", ".", "gsbare"}], "/", 
    RowBox[{"gsbare", ".", "normm", ".", "gsbare"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"transfeb", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.887524978186491*^9, 3.887525011892652*^9}, {
   3.887525047440764*^9, 3.887525065877193*^9}, {3.88752511947143*^9, 
   3.887525142612657*^9}, 3.8875251835765667`*^9, {3.887525241869048*^9, 
   3.887525242553217*^9}, 3.8875252733430643`*^9, {3.887525380701973*^9, 
   3.887525391106378*^9}},
 CellLabel->
  "In[1114]:=",ExpressionUUID->"1e165106-6176-4e05-8bf4-83788eae4ef0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6829400882230815`", ",", 
   RowBox[{"-", "0.07847899254996926`"}], ",", "0.17127315128799314`", ",", 
   "0.7057615682892289`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8875252277431107`*^9, 3.887525243179616*^9}, 
   3.887525273971887*^9, 3.887525392125288*^9},
 CellLabel->
  "Out[1116]=",ExpressionUUID->"ec7b1520-5fde-46ba-93f7-629622ea4d3e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*TemplateBox[{\\\"0\\\"},\\\"Bra\\\"]\\)H\\!\\(\\*\
TemplateBox[{\\\"0\\\"},\\\"Ket\\\"]\\) = \"\>", "\[InvisibleSpace]", 
   "0.060333893378484854`"}],
  SequenceForm[
  "\!\(\*TemplateBox[{\"0\"},\"Bra\"]\)H\!\(\*TemplateBox[{\"0\"},\"Ket\"]\) \
= ", 0.060333893378484854`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.887525227744319*^9, 3.887525243180622*^9}, 
   3.887525273972724*^9, 3.887525392126059*^9},
 CellLabel->
  "During evaluation of \
In[1114]:=",ExpressionUUID->"b91fc34f-e7a6-4a57-bf93-da3e08ca2a25"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6829400882230815`", 
      RowBox[{"-", "0.07847899254996926`"}], "0.17127315128799314`", 
      "0.7057615682892289`"},
     {"0.036178302060388044`", 
      RowBox[{"-", "0.7050326956787915`"}], 
      RowBox[{"-", "0.029229935526760478`"}], 
      RowBox[{"-", "0.7076479628692683`"}]},
     {"0.0015182793183768843`", 
      RowBox[{"-", "0.049859623410789276`"}], "0.8167058609416002`", 
      "0.574894120238575`"},
     {
      RowBox[{"-", "0.00007230944981939377`"}], "0.002405678662100288`", 
      RowBox[{"-", "0.07192873910532492`"}], "0.9974068698240635`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8875252277431107`*^9, 3.887525243179616*^9}, 
   3.887525273971887*^9, 3.8875253921267443`*^9},
 CellLabel->
  "Out[1118]//MatrixForm=",ExpressionUUID->"9f7422bb-cd8c-45a8-a2c7-\
3449845f7e75"]
}, Open  ]]
},
WindowSize->{960., 1052.25},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e6fae5da-121f-4443-9cc4-7a37880ac916"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1114, 26, 87, "Input",ExpressionUUID->"cf04348f-7816-4b2f-8ae2-b22df846011d",
 InitializationCell->True],
Cell[1697, 50, 271, 4, 33, "Output",ExpressionUUID->"5448ef81-d223-4d20-a149-b1fc642ab85b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2005, 59, 4471, 87, 211, "Input",ExpressionUUID->"35efcf03-bbc1-49e6-a283-337798143983",
 InitializationCell->True],
Cell[6479, 148, 3871, 54, 23, "Print",ExpressionUUID->"f4f01b11-fb9a-4aaf-a344-d38ebd9690e4"]
}, Open  ]],
Cell[10365, 205, 2429, 56, 90, "Input",ExpressionUUID->"2bc62ebd-0e32-4e49-a5c6-4cabc9396e9a",
 InitializationCell->True],
Cell[12797, 263, 6356, 120, 173, "Input",ExpressionUUID->"5a238007-b3e1-452b-8b3b-7c130bd86630",
 InitializationCell->True],
Cell[19156, 385, 805, 19, 128, "Text",ExpressionUUID->"269e7c8d-2cf8-4c63-89c4-007a731f559b"],
Cell[CellGroupData[{
Cell[19986, 408, 15636, 341, 826, "Input",ExpressionUUID->"b4405cc3-3da0-4835-956c-ca9ff5f86c93"],
Cell[CellGroupData[{
Cell[35647, 753, 677, 14, 23, "Print",ExpressionUUID->"b7718fbd-8136-4639-90c8-b62214262d7d"],
Cell[36327, 769, 712, 15, 26, "Print",ExpressionUUID->"38567fd7-b0d2-4a57-8a7a-31c27e511c49"],
Cell[37042, 786, 1511, 29, 48, "Print",ExpressionUUID->"ce9e6c48-5183-4604-8ebb-e53a4ae45583"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38602, 821, 1531, 41, 114, "Input",ExpressionUUID->"1e165106-6176-4e05-8bf4-83788eae4ef0"],
Cell[40136, 864, 390, 8, 33, "Output",ExpressionUUID->"ec7b1520-5fde-46ba-93f7-629622ea4d3e"],
Cell[40529, 874, 584, 13, 26, "Print",ExpressionUUID->"b91fc34f-e7a6-4a57-bf93-da3e08ca2a25"],
Cell[41116, 889, 1245, 31, 96, "Output",ExpressionUUID->"9f7422bb-cd8c-45a8-a2c7-3449845f7e75"]
}, Open  ]]
}
]
*)

