import os
import numpy as np

two_body_channels = {
    # r7 c2:    J              S  L              S_c
    'np1s': 1,  #  1   :   0  0  1S0         0
    'np3s': 2,  #  2   :   1  0  3S1         2
    'nn1s': 3,  #  4   :   0  0  1S0         0
    'nn3p': 4,  #  5   :   1  1  3P0,3P1,3P2 2
    'nn1d': 5,  #  6   :   0  2  1D2         2
    'nn3f': 6,  #  7   :   0  1  3F2,3F3,3F4 0
    'np1p': 7,  #  8   :   1  1  1P1         2
    'np3p': 8,  #  9   :   1  2  3P0,3P1,3P2 2
    'np3d': 9,  #  9   :   1  2  3D1,3D2,3D3 2
    'pp1s': 10,  #  9   :   1  2  1S0         2
    'pp3p': 11,  #  9   :   1  2  3P0,3P1,3P2 2
    'pp1d': 12,  #  9   :   1  2  1D0         2
    'pp3f': 13,  #  9   :   1  2  3F2,3F3,3F4 2
}

dict_3to4 = {
    't_no1': [['000-0'], ['tp_1s0']],
    't_no6': [['000-0'], ['tp_6s0']],
    'he_no1': [['000-0'], ['hen_1s0']],
    'he_no6': [['000-0'], ['hen_6s0']],
}

# -- LEC lists

lec_list_oneMEV = {}
lec_list_c = {}
lec_set_0__2__8 = {}

lec_set_0__2__8 = {
    '0.10': [-4.6123, -0.1936, -3.8940, -2.3037],  #-283.0033,-11280.2471],
    '0.20': [-6.4580, -0.8196, -8.1672, -3.5258],
    '0.30': [-9.1636, -1.9755, -13.5804, -4.4469],
    '0.40': [-12.5121, -3.6770, -20.2142, -5.0849],
    '0.50': [-16.4416, -5.9296, -28.0746, -5.3996],
    '0.60': [-20.9366, -8.7356, -37.1393, -5.3323],
    '0.70': [-25.9923, -12.0962, -47.3817, -4.8220],
    '0.80': [-31.6067, -16.0120, -58.7735, -3.8083],
    '0.90': [-37.7792, -20.4834, -71.2874, -2.2325],
    '1.00': [-44.4616, -25.5107, -84.9683, -0.1070],
    '1.10': [-51.7480, -31.0941, -99.6513, 2.7614],
    '1.20': [-59.5911, -37.2336, -115.3801, 6.3644],
    '1.30': [-67.9910, -43.9293, -132.1302, 10.7600],
    '1.40': [-76.9475, -51.1814, -149.8776, 16.0070],
    '1.50': [-86.4986, -58.9898, -168.5303, 22.2441],
    '1.60': [-96.5693, -67.3545, -188.2002, 29.3782],
    '1.70': [-107.1967, -76.2756, -208.7994, 37.5440],
    '1.80': [-118.3808, -85.7532, -230.3065, 46.8032],
    '1.90': [-130.1215, -95.7872, -252.6999, 57.2199],
    '2.00': [-142.4187, -106.3776, -275.9588, 68.8584],
    '2.10': [-155.2725, -117.5245, -300.0624, 81.7859],
    '2.20': [-168.6829, -129.2278, -324.9893, 96.0717],
    '2.30': [-182.6500, -141.4877, -350.7195, 111.7864],
    '2.40': [-197.1736, -154.3040, -377.2325, 129.0031],
    '2.50': [-212.2537, -167.6768, -404.5088, 147.7963],
    '2.60': [-227.8904, -181.6061, -432.5277, 168.2444],
    '2.70': [-244.0836, -196.0918, -461.2696, 190.4276],
    '2.80': [-260.8334, -211.1341, -490.7150, 214.4290],
    '2.90': [-278.1398, -226.7329, -520.8432, 240.3359],
    '3.00': [-296.0026, -242.8881, -551.6373, 268.2337],
    '3.10': [-314.4220, -259.5999, -583.0751, 298.2191],
    '3.20': [-333.3980, -276.8681, -615.1380, 330.3862],
    '3.30': [-352.9306, -294.6929, -647.8073, 364.8345],
    '3.40': [-373.0196, -313.0742, -681.0644, 401.6651],
    '3.50': [-393.6652, -332.0120, -714.8885, 440.9885],
    '3.60': [-414.8673, -351.5063, -749.2626, 482.9143],
    '3.70': [-436.6260, -371.5571, -784.1665, 527.5574],
    '3.80': [-458.9412, -392.1645, -819.5817, 575.0401],
    '3.90': [-481.8129, -413.3283, -855.4896, 625.4872],
    '4.00': [-505.2412, -435.0487, -891.8720, 679.0272],
    '4.10': [-529.2260, -457.3255, -928.7091, 735.7975],
    '4.20': [-553.7673, -480.1590, -965.9837, 795.9370],
    '4.30': [-578.8652, -503.5488, -1003.6780, 859.5922],
    '4.40': [-604.5196, -527.4953, -1041.7714, 926.9193],
    '4.50': [-630.7305, -551.9982, -1080.2490, 998.0730],
    '4.60': [-657.4980, -577.0577, -1119.0900, 1073.2222],
    '4.70': [-684.8220, -602.6736, -1158.2783, 1152.5375],
    '4.80': [-712.7025, -628.8462, -1197.7969, 1236.2004],
    '4.90': [-741.1395, -655.5752, -1237.6232, 1324.3964],
    '5.00': [-770.1331, -682.8607, -1277.7470, 1417.3252],
    '5.10': [-799.6831, -710.7028, -1318.1400, 1515.1846],
    '5.20': [-829.7898, -739.1013, -1358.8029, 1618.1943],
    '5.30': [-860.4529, -768.0564, -1399.6945, 1726.5684],
    '5.40': [-891.6726, -797.5680, -1440.8180, 1840.5424],
    '5.50': [-923.4488, -827.6362, -1482.1579, 1960.3561],
    '5.60': [-955.7816, -858.2608, -1523.6726, 2086.2627],
    '5.70': [-988.6708, -889.4420, -1565.3693, 2218.5202],
    '5.80': [-1022.1166, -921.1797, -1607.2288, 2357.4064],
    '5.90': [-1056.1189, -953.4739, -1649.2451, 2503.2080],
    '6.00': [-1090.6288, -986.2972, -1691.7464, 2654.5400],
    '6.10': [-1125.9842, -1019.7202, -1732.4750, 2821.6762],
    '6.20': [-1161.8838, -1053.6988, -1773.3227, 2997.0193],
    '6.30': [-1198.3227, -1088.2327, -1814.2941, 3180.7520],
    '6.40': [-1235.2963, -1123.3216, -1855.4322, 3373.0431],
    '6.50': [-1272.7997, -1158.9654, -1896.7438, 3574.0280],
    '6.60': [-1310.8282, -1195.1636, -1938.3152, 3783.8163],
    '6.70': [-1349.3769, -1231.9160, -1980.0782, 4002.4960],
    '6.80': [-1388.4413, -1269.2223, -2022.1012, 4230.1342],
    '6.90': [-1428.0322, -1307.0832, -2064.3734, 4467.3745],
    '7.00': [-1468.1752, -1345.5003, -2106.6157, 4715.6575],
    '7.10': [-1508.8153, -1384.4132, -2149.5672, 4971.2934],
    '7.20': [-1550.0728, -1423.9422, -2191.7483, 5243.3354],
    '7.30': [-1591.8884, -1464.0278, -2233.8453, 5528.2217],
    '7.40': [-1634.2625, -1504.6698, -2275.8782, 5826.5271],
    '7.50': [-1677.1953, -1545.8683, -2317.7633, 6138.8924],
    '7.60': [-1720.6875, -1587.6234, -2359.5292, 6465.9681],
    '7.70': [-1764.7394, -1629.9351, -2401.1642, 6808.4541],
    '7.80': [-1809.3517, -1672.8032, -2442.6331, 7167.0543],
    '7.90': [-1854.5251, -1716.2279, -2483.9026, 7542.6301],
    '8.00': [-1898.622, -1760.1617, -2539.1703, 7818.9764],
    '8.10': [-1946.5580, -1804.7468, -2565.9344, 8347.9434],
    '8.20': [-1993.4193, -1849.8410, -2606.5702, 8779.5361],
    '8.30': [-2040.8451, -1895.4917, -2646.9174, 9231.7961],
    '8.40': [-2088.8366, -1941.6989, -2687.0005, 9705.7870],
    '8.50': [-2137.3949, -1988.4628, -2726.7835, 10202.6524],
    '8.60': [-2186.5214, -2035.7831, -2766.2514, 10723.7283],
    '8.70': [-2236.2176, -2083.6600, -2805.3479, 11270.2930],
    '8.80': [-2286.4850, -2132.0933, -2844.0766, 11843.8666],
    '8.90': [0.0, 0.0, -2844.0766, 11843.8666],
    '9.00': [0.0, 0.0, -2844.0766, 11843.8666],
    '10.0': [-2933.5564, -2756.7025, -3281.2439, 21297.6851],
    '14.0': [-5676.2972, -5417.5158, -4310.1766, 144399.039]
}

lec_list_c[
    '450'] = {  #                            E_pp=12    a_pp=7.766    a_pp=3.0
        '2.00':
        [-163.71595, -157.447133, 157.961, -3.267336, 39.607794, -7.87235],
        '4.00':
        [-483.66597, -473.014504, 837.417, -9.154840, 70.028319, 8.869022],
        '6.00':
        [-974.12019, -959.080826, 2710.51, -16.53103, 98.155928, 17.98276],
        '8.00':
        [-1635.0553, -1615.626551, 7181.98, -24.93847, 124.958616, 26.50637],
        '10.0':
        [-2466.4663, -2442.646318, 17329.9, -34.22299, 150.757077, 34.34971],
        '12.0':
        [-3468.3515, -3440.139992, 40042.8, -44.21432, 175.702462, 37.62653],
        '15.0': [
            -5290.8112, -5256.012203, 136994.4343, -60.31870, 211.985648,
            45.16885
        ]
    }

lec_list_c['805'] = {  #                       E_pp=15   a_pp=3.0
    '2.00': [-148.020, -138.168, 71.0200, -2.125143, 6.908400],
    '4.00': [-404.629, -388.507, 353.8714, -6.886135, 31.56619],
    '6.00': [-789.207, -766.806, 1001.2247, -12.97822, 47.92537],
    #'6.00': [-974.12019, -959.080826, 2710.51, -12.97822, 47.92537],
    '8.00': [-1301.721, -1273.037, 2220.7696, -20.06991, 63.65185],
    '10.0': [-1941.969, -1907.003, 4307.9937, -28.14412, 77.47199],
    '12.0': [-2710.252, -2668.999, 7711.9141, -36.76308, 91.74684],
    '15.0': [-4102.503, -4051.821, 16837.2070, -50.77141, 113.9574]
}

lec_list_oneMEV['137'] = {  #d0GS TNI-UIX  ZENTRAL NNN   PROJ           d0ES
    '0.05': [-1.551665, 0.324253617188],
    '0.10': [-2.241663, 0.2456829375],
    '0.16': [-3.25382381543, 0.0190507091372],
    '0.20': [-4.040227, -0.223247242969],
    '0.22': [-4.46682689578, -0.374771360196],
    '0.25': [-5.14850032428, -0.641645783435],
    '0.30': [-6.396510, -1.20682104512],
    '0.35': [-7.8083, -1.98064161217],
    '0.40': [-9.31007578154, -2.82776987047],
    '0.45': [-10.9761364604, -3.91309051448],
    '0.50': [-12.78163, -5.20893734689],
    '0.55': [-14.7258111587, -6.71792212184],
    '0.60': [-16.8090746843, -8.46827168904],
    '0.65': [-19.03174482, -10.4630055535],
    '0.70': [-21.39405, -12.7344455911],
    '0.75': [-23.8940370852, -15.2760761543],
    '0.80': [-26.53580, -18.1374520182],
    '0.90': [-32.23375, -24.8126425911],
    '0.95': [-35.29122, -28.6644794764],
    '1.00': [-38.48853, -32.9110143276],
    '1.05': [-41.82441, -37.5268116221],
    '1.10': [-45.29949, -42.5703870486],
    '1.20': [-52.66596, -53.9705109645],
    '1.50': [-78.11106, -100.476136019],
    '2.00': [-131.64598, -232.412644337],
    '3.00': [-280.45691, -854.107499493],
    '4.00': [-484.92093, -2495.36419052],
    '6.00': [-1060.7967, -16915.6302127],
    #'10.0': [-2880.3865, -756723.220071],
    # TNI below is fitted to B(3) = 8.48
    '10.0': [-2880.3865, -29933.4954397]
}

lec_list_def = {  #d0GS TNI-UIX  ZENTRAL NNN   PROJ           d0ES
    '0.50': [-16.3721, 4.436],
    '0.75': [-28.6714, 12.936],
    '1.00': [-44.4515, 27.245],
    '1.50': [-86.4495, 79.22],
    '2.00': [-142.3625, 173.925],
    '3.00': [-295.93, 558.49338400],
    '4.00': [-505.15, 1395.62624049],
    '6.00': [-1090.548, 6293.03337496],
    '8.00': [-1898.553, 23937.61505980],
    '10.0': [-2929.165, 85318.84107084]
}

lec_list_c[
    '137'] = {  #d0GS  TNI-UIX  ZENTRAL    NNN        PROJ           d0ES
        '2.00':
        [-142.364, -106.2793, 68.488, 66.8240, 33.4723, -276.2272, -0.830307],
        '4.00': [
            -505.164, -434.9584, 677.799, 724.4771, 338.7663, -892.3704,
            -7.645753
        ],
        '6.00': [
            -1090.584, -986.2518, 2652.651, 3198.9831, 1355.3977, -1692.1660,
            -16.854889
        ],
        '8.00': [
            -1898.622, -1760.1617, 7816.228, 0.0, 4101.7017, -2539.0099,
            -27.502527
        ],
        '10.0': [
            -2929.277, -2756.6884, 20483.217, 0.0, 11095.8257, -3328.0227,
            -39.169742
        ],
        '12.0': [
            -4182.363, -3975.6195, 50939.941, 0.0, 28724.6969, -3999.5813,
            -52.024708
        ],
        '15.0': [
            -6479.576, -6221.5028, 195570.801, 0.0, 118778.9520, -4694.7019,
            -71.996883
        ]
    }

w120 = [
    129.5665, 51.3467, 29.47287, 13.42339, 8.2144556, 4.447413, 2.939,
    1.6901745, 1.185236, 0.84300, 0.50011, 0.257369, 0.13852, 0.071429,
    0.038519, 0.018573, 0.0097261, 0.00561943, 0.002765, 0.00101
]
w12 = [
    12.95665, 5.13467, 2.947287, 1.342339, .82144556, .4447413, 2.939,
    1.6901745, 1.185236, 0.84300, 0.50011, 0.257369, 0.13852, 0.071429,
    0.038519, 0.018573, 0.0097261, 0.00561943, 0.002765, 0.00101
]

mn = {
    '137': 938.91852,
    '300': 1053.0,
    '450': 1226.0,
    '510': 1320.0,
    '805': 1634.0
}

home = os.getcwd()

pathbase = home + '/..'
BINBDGpath = pathbase + '/src_nucl/'

# NN: tnni=10   NN+NNN: tnni=11
tnni = 11
tnnifac = 1.
tnf = 1.
parall = -1

# limits the number of parallel processes in a single process pool
# if running on my laptop, I need to set this number in order to avoid
# too many files too be opened simulataneously
maxParLen = 120

lec_set = lec_list_def  #lec_set_0__2__8

lam = 10.0  #3.00 4.00 6.00 8.00 10.0

la = ('%-4.2f' % lam)[:4]

if la in lec_set.keys():
    pass
else:
    print('LECs unavailable for chosen cutoff! Available cutoffs:\n',
          lec_set.keys())
    exit()

channels_2 = {
    # L    J
    'np1s': ['0', '0'],
}

channels_3 = {
    'he': ['000', ['he_no1', 'he_no6']],
    't': ['000', ['t_no1', 't_no6']],
}

sysdir2base = pathbase + '/systems/2/%s' % la
sysdir3base = pathbase + '/systems/3/%s' % la
sysdir4 = pathbase + '/systems/4/%s' % la

nnpotstring = 'nn_pot'
nnnpotstring = 'nnn_pot'

nnpot = sysdir2base + '/' + nnpotstring
nnnpot = sysdir2base + '/' + nnnpotstring

# B2 = 1 MeV and B3 = 8.48 MeV
try:
    cloW = 0.5 * (lec_set[la][0] + lec_set[la][1])
    cloB = 0.5 * (lec_set[la][0] - lec_set[la][1])
    d0 = lec_set[la][3]
except:
    cloW = lec_set[la][0]
    cloB = 0.0
    d0 = lec_set[la][1]

evWindow = [-30, 150]

withCoul = False

nzEN = 200
E0 = 0.001
D0 = 0.04
Eps = 0.01
Bet = 2.1

MeVfm = 197.3161329

widthSet_relative = w12

eps = np.finfo(float).eps
